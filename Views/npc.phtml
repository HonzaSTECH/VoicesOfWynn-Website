<h1><?= ${basename(__FILE__, '.phtml').'_npc'}->getName() ?></h1>
<img src="dynamic/npcs/<?= ${basename(__FILE__, '.phtml').'_npc'}->getName() ?>.png" alt="NPC picture" />
<p>
    <strong>Voice actor: </strong>
    <?php if (${basename(__FILE__, '.phtml').'_voiceActor'} === null) : ?>
        <i>Nobody</i>
    <?php else : ?>
        <img class="avatar" src="dynamic/avatars/<?= ${basename(__FILE__, '.phtml').'_voiceActor'}->getAvatarLink() ?>" alt="Profile picture" />
        <?= ${basename(__FILE__, '.phtml').'_voiceActor'}->getName() ?>
    <?php endif ?>
    <button id="change-actor-btn">Change</button>
</p>

<h3>Recordings</h3>
<?php foreach (${basename(__FILE__, '.phtml').'_quest_recordings'} as $quest) : ?>
<section>
    <table>
        <tr><th><?= $quest->getName() ?></th></tr>
	    <?php $recordings = $quest->getNpcs()[0]->getRecordings(); ?>
        <?php foreach ($recordings as $recording) : ?>
        <tr>
            <td># <?= $recording->line ?></td>
            <td>
                <audio controls>
                    <source src="dynamic/recordings/<?= $recording->file ?>" type="audio/ogg">
                    Your browser does not support the OGG audio format.
                </audio>
            <td style="color: green; font-weight: bolder;"><?= $recording->upvotes ?></td>
            <td style="color: red; font-weight: bolder;"><?= $recording->downvotes ?></td>
        </tr>
        <?php endforeach ?>
    </table>
    <form method="post" enctype="multipart/form-data" class="new-recording-form">
        <h4>Add new recording</h4>
        <input name="questId" type="hidden" value="<?= $quest->getId() ?>" />
        <table>
            <tr><th>File</th><th>Line #</th></tr>
            <tbody class="new-recording-items-container">
                <tr class="new-recording-item">
                    <td>
                        <input name="recording1" type="file" accept="audio/ogg" class="recording-input" required/>
                    </td>
                    <td>
                        <input name="line1" type="number" min="1" max="32767" value="<?= count($recordings)+1 ?>" class="line-input" required/>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="add-more-recordings-button">Add more</button>
        <input type="submit" value="Upload"/>
    </form>
    <?php if (isset(${basename(__FILE__, '.phtml').'_uploadErrors'}[$quest->getId()])) : ?>
        <?= ${basename(__FILE__, '.phtml').'_uploadErrors'}[$quest->getId()] ?>
    <?php endif ?>
</section>
<?php endforeach ?>
